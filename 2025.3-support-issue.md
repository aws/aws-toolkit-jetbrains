# Issue: Adding 2025.3 Support to AWS Toolkit for JetBrains

## Problem Summary
Unable to resolve IntelliJ Platform dependencies when adding 2025.3 EAP support to the AWS Toolkit. Build fails with "No IntelliJ Platform dependency found" errors.

## Background
- **Goal**: Add JetBrains 2025.3 EAP support to AWS Toolkit
- **Branch**: `add-2025-3-support` 
- **Key Change**: JetBrains discontinued IC (Community Edition) for 2025.3, moved to unified platform

## Error Evolution
1. **Initial**: `No IntelliJ Platform dependency found with 'IC-2025.3 (non-installer)'`
2. **After IdeFlavor changes**: `No IntelliJ Platform dependency found with 'IU-2025.3 (non-installer)'`
3. **After EAP format**: `No IntelliJ Platform dependency found with 'IU-2025.3-EAP-SNAPSHOT (non-installer)'`
4. **Current**: `No IntelliJ Platform dependency found with 'IU-253.25908.13 (non-installer)'`

## What We've Tried

### 1. SDK Version Formats
- ✅ `"2025.3"` → ❌ Doesn't exist for IC
- ✅ `"253.25908.29"` → ❌ Complex build number approach
- ✅ `"2025.3-EAP-SNAPSHOT"` → ❌ EAP snapshot format
- ✅ `"253.25908.13"` → ❌ Specific IU build number

### 2. IdeFlavor Changes
- ✅ Changed all `IdeFlavor.IC` → `IdeFlavor.IU` in:
  - `plugins/core/jetbrains-community/build.gradle.kts`
  - `plugins/amazonq/*/jetbrains-community/build.gradle.kts` (4 modules)
  - `plugins/toolkit/jetbrains-core/build.gradle.kts`
  - `buildSrc/src/main/kotlin/toolkit-intellij-plugin.gradle.kts` (default fallback)

### 3. Verification Steps
- ✅ Confirmed `253.25908.13` exists in JetBrains EAP releases for IU
- ✅ Updated marketplace plugin versions to matching build numbers
- ✅ Rider kept as `2025.3-SNAPSHOT` (works fine)

## Senior Engineer Feedback ✅

### 1. SDK Version Solution
**Correct format**: `253.25908-EAP-CANDIDATE-SNAPSHOT`
- **Source**: https://www.jetbrains.com/intellij-repository/snapshots
- **Issue**: We were using `253.25908.13` instead of the snapshot format

### 2. IdeFlavor Strategy 
**Need version-conditional logic**:
```kotlin
// For community builds, use version-based logic:
when (version) {
    older_versions -> IdeFlavor.IC  // Keep IC for older versions
    "2025.3"+ -> IdeFlavor.IU       // Use IU for 2025.3+
}
```

### 3. Platform Coordinates (Advanced)
**Alternative approach using Maven coordinates**:
```kotlin
// Instead of IdeFlavor, could use direct coordinates:
IntellijIdeaUltimate(
    code = "IU",
    maven = Coordinates("com.jetbrains.intellij.idea", "ideaIU"),
    installer = Coordinates("idea", "ideaIU"),
),
IntellijIdea(
    code = "IU", 
    maven = Coordinates("com.jetbrains.intellij.idea", "idea"),
    installer = Coordinates("idea", "idea"),
)
```
**Translation**: This bypasses IdeFlavor and directly specifies Maven artifact coordinates

## Updated Configuration Needed
```kotlin
// IdeVersions.kt - CORRECTED
Profile(
    name = "2025.3",
    gateway = ProductProfile(sdkVersion = "253.25908-EAP-CANDIDATE-SNAPSHOT", ...),
    community = ProductProfile(sdkVersion = "253.25908-EAP-CANDIDATE-SNAPSHOT", ...),
    ultimate = ProductProfile(sdkVersion = "253.25908-EAP-CANDIDATE-SNAPSHOT", ...),
    rider = RiderProfile(sdkVersion = "2025.3-SNAPSHOT", ...)
)

// Version-conditional IdeFlavor logic needed:
intellijToolkit {
    ideFlavor.set(
        if (version >= "2025.3") IdeFlavor.IU 
        else IdeFlavor.IC
    )
}
```

## Remaining Questions

1. **Version Detection**: How to detect current IDE version in build script for conditional logic?
2. **Maven Coordinates**: Should we implement the direct coordinates approach instead of IdeFlavor?
3. **Backward Compatibility**: How to ensure older versions (2024.x) still work with IC?

## Repository State
- **Fork**: `https://github.com/aseemxs/aws-toolkit-jetbrains.git`
- **Branch**: `add-2025-3-support`
- **Commits**: 7 commits attempting various fixes
- **Status**: All changes pushed, ready for review

## References
- [JetBrains Platform Gradle Plugin Docs](https://plugins.jetbrains.com/docs/intellij/tools-intellij-platform-gradle-plugin-dependencies-extension.html)
- [IntelliJ Platform Gradle Plugin 2.0 Blog](https://blog.jetbrains.com/platform/2024/07/intellij-platform-gradle-plugin-2-0/)
- [IC Deprecation Discussion](https://platform.jetbrains.com/t/intellij-platform-gradle-plugins-intellijideacommunity-deprecation/2709)

## Next Steps Needed
Senior engineer guidance on:
1. Correct dependency resolution approach for 2025.3 EAP
2. Whether our IdeFlavor mapping strategy is correct
3. Any missing configuration or repository setup
