<!-- Copyright 2024 Amazon.com, Inc. or its affiliates. All Rights Reserved. -->
<!-- SPDX-License-Identifier: Apache-2.0 -->

<idea-plugin xmlns:xi="http://www.w3.org/2001/XInclude" require-restart="true">
    <id>amazon.q</id>
    <name>Amazon Q</name>
    <description><![CDATA[
    <p>The most capable generative AI-powered assistant for building, operating, and transforming software, with advanced capabilities for managing data and AI</p>

    <h2>Agentic coding experience</h2>
	<p>Amazon Q Developer uses information across native and MCP server-based tools to intelligently perform actions beyond code suggestions, such as reading files, generating code diffs, and running commands based on your natural language instruction. Simply type your prompt in your preferred language and Q Developer will provide continuous status updates and iteratively apply changes based on your feedback, helping you accomplish tasks faster.</p>

    <h3>Implement new features</h3>
    <p>Generate new code across your entire project and implement features.</p>

    <h3>Generate documentation</h3>
    <p>Write API, technical design, and onboarding documentation.</p>

    <h3>Automate code reviews</h3>
    <p>Perform code reviews, flagging suspicious code patterns and assessing deployment risk.</p>

    <h3>Generate unit tests</h3>
    <p>Generate unit tests and add them to your project, helping you improve code quality, fast.</p>

    <h3>Transform workloads</h3>
    <p><code>/transform</code> to upgrade your Java applications in minutes, not weeks.</p>

    <h2>Core features</h2>

	<h3>MCP support</h3>
    <p>Add Model Context Protocol (MCP) servers to give Amazon Q Developer access to important context.</p>

    <h3>Inline suggestions</h3>
    <p>Receive real-time code suggestions ranging from snippets to full functions based on your comments and existing code.</p>
    <p><i><a href="https://docs.aws.amazon.com/amazonq/latest/qdeveloper-ug/q-language-ide-support.html">15+ languages supported including Python, TypeScript, Rust, Terraform, AWS Cloudformation, and more</a></i></p>

    <h3>Inline chat</h3>
    <p>Seamlessly initial chat within the inline coding experience. Select a section of code that you need assistance with and initiate chat within the editor to request actions such as "Optimize this code", "Add comments", or "Write tests".</p>

    <h3>Chat</h3>
    <p>Generate code, explain code, and get answers about software development.</p>

    <h3>Code reference log</h3>
    <p>Attribute code from Amazon Q that is similar to training data. When code suggestions similar to training data are accepted, they will be added to the code reference log.</p>

    <h1>Getting Started</h1>
    <p><b>Free Tier</b> - create or log in with an AWS Builder ID (a personal profile from AWS).</p>
    <p><b>Pro Tier</b> - if your organization is on the Amazon Q Developer Pro tier, log in with single sign-on.</p>

    <img src="https://raw.githubusercontent.com/aws/aws-toolkit-jetbrains/main/marketplaceGifs/JB-auth-Q.gif"></img>

    <h3>Troubleshooting & feedback</h3>
    <p><a href="https://github.com/aws/aws-toolkit-jetbrains/issues/new?labels=bug&template=bug_report.md">File a bug</a> or <a href="https://github.com/aws/aws-toolkit-jetbrains/issues/new?labels=feature-request&template=feature_request.md">submit a feature request</a> on our Github repository.</p>

]]></description>
    <version>1.0</version>
    <vendor email="aws-toolkit-jetbrains@amazon.com" url="https://github.com/aws/aws-toolkit-jetbrains">AWS</vendor>
    <idea-version since-build="232" />
    <depends>com.intellij.modules.platform</depends>
    <depends optional="true">org.jetbrains.idea.maven</depends>
    <resource-bundle>software.aws.toolkits.resources.MessagesBundle</resource-bundle>

    <depends>com.intellij.modules.lang</depends>

    <depends optional="true" config-file="amazonq-ext-codewithme.xml">com.jetbrains.codeWithMe</depends>
    <depends optional="true" config-file="amazonq-ext-java.xml">com.intellij.java</depends>
    <depends optional="true" config-file="amazonq-ext-nodejs.xml">JavaScriptDebugger</depends>
    <depends optional="true" config-file="amazonq-ext-python.xml">com.intellij.modules.python</depends>

    <incompatible-with>com.intellij.cwm.guest</incompatible-with>
    <incompatible-with>com.intellij.jetbrains.client</incompatible-with>
    <incompatible-with>com.intellij.gateway</incompatible-with>

    <extensionPoints>
        <extensionPoint qualifiedName="amazon.q.connection.pinned.feature" interface="software.amazon.q.jetbrains.core.credentials.pinning.FeatureWithPinnedConnection"
                        dynamic="true"/>
        <extensionPoint qualifiedName="amazon.q.credentialProviderFactory" interface="software.amazon.q.core.credentials.CredentialProviderFactory" dynamic="true"/>
        <extensionPoint qualifiedName="amazon.q.startupAuthFactory" interface="software.amazon.q.jetbrains.core.credentials.ToolkitStartupAuthFactory" dynamic="true"/>
        <extensionPoint qualifiedName="amazon.q.sdk.clientCustomizer" interface="software.amazon.q.core.ToolkitClientCustomizer" dynamic="true"/>

        <extensionPoint qualifiedName="software.aws.toolkits.jetbrains.moduleDependencyProvider"
                        interface="software.aws.toolkits.jetbrains.services.amazonq.lsp.dependencies.ModuleDependencyProvider"
                        dynamic="true"/>

        <extensionPoint qualifiedName="software.aws.toolkits.jetbrains.problemsViewMutator"
                        interface="software.aws.toolkits.jetbrains.ProblemsViewMutator"
                        dynamic="true" />
    </extensionPoints>

    <extensions defaultExtensionNs="software.aws.toolkits.jetbrains">
        <problemsViewMutator implementation="software.aws.toolkits.jetbrains.DefaultProblemsViewMutator"/>
    </extensions>

    <extensions defaultExtensionNs="amazon.q">
        <credentialProviderFactory implementation="software.amazon.q.jetbrains.core.credentials.profiles.ProfileCredentialProviderFactory"/>

        <!-- need to resolve hard dependency on telemetry querying the status of these -->
        <connection.pinned.feature implementation="software.amazon.q.jetbrains.core.credentials.pinning.CodeCatalystConnection"/>
        <connection.pinned.feature implementation="software.amazon.q.jetbrains.core.credentials.pinning.QConnection"/>
    </extensions>

    <xi:include href="/META-INF/module-amazonq.xml" />

    <xi:include href="/META-INF/change-notes.xml" xpointer="xpointer(/idea-plugin/*)">
        <xi:fallback/>
    </xi:include>

    <extensions defaultExtensionNs="com.intellij">
        <applicationConfigurable
            id="aws"
            groupId="tools"
            bundle="software.aws.toolkits.resources.MessagesBundle"
            key="aws.settings.title"
            instance="software.amazon.q.jetbrains.settings.AwsSettingsSharedConfigurable"
        />

        <registryKey key="amazon.q.endpoint" description="Endpoint to use for Amazon Q"
                     defaultValue="" restartRequired="true"/>
        <registryKey key="amazon.q.endpoints.json" description="List of region-endpoint pairs in JSON array form"
                     defaultValue=""
                     restartRequired="true"/>
        <registryKey key="inline.completion.rem.dev.use.rhizome" description="Defined by IntelliJ. Used for Amazon Q to display suggestions on remote."
                     defaultValue="false" restartRequired="true"/>
        <registryKey defaultValue=""
                     description="Endpoint to use to download flare artifacts"
                     key="amazon.q.flare.endpoint"/>
        <registryKey key="aws.dev.useDAG" description="True if DAG should be used instead of authorization_grant with PKCE"
                     defaultValue="false" restartRequired="false" overrides="true"/>
        <registryKey key="aws.telemetry.endpoint" description="Endpoint to use for publishing AWS client-side telemetry"
                     defaultValue="https://client-telemetry.us-east-1.amazonaws.com" restartRequired="true" overrides="true"/>
        <registryKey key="aws.telemetry.identityPool" description="Cognito identity pool to use for publishing AWS client-side telemetry"
                     defaultValue="us-east-1:820fd6d1-95c0-4ca4-bffb-3f01d32da842" restartRequired="true" overrides="true"/>
        <registryKey key="aws.telemetry.region" description="Region to use for publishing AWS client-side telemetry" defaultValue="us-east-1"
                     restartRequired="true" overrides="true"/>
        <registryKey key="aws.toolkit.developerMode" description="Enables features to facilitate development of the toolkit" restartRequired="false"
                     defaultValue="false" overrides="true"/>
        <registryKey key="aws.toolkit.notification.endpoint" description="Endpoint for AWS Toolkit notifications"
                     defaultValue="https://idetoolkits-hostedfiles.amazonaws.com/Notifications/Jetbrains/combined/2.x.json" restartRequired="true"
                     overrides="true"/>

        <webHelpProvider implementation="software.amazon.q.jetbrains.core.help.HelpIdTranslator"/>
]
        <httpRequestHandler implementation="software.amazon.q.jetbrains.core.credentials.sso.pkce.ToolkitOAuthCallbackHandler"/>
        <httpRequestHandler implementation="software.amazon.q.jetbrains.core.credentials.sso.pkce.ToolkitOAuthCallbackResultService"/>

        <postStartupActivity implementation="software.amazon.q.jetbrains.core.plugin.PluginAutoUpdater"/>
        <postStartupActivity implementation="software.amazon.q.jetbrains.core.AwsTelemetryPrompter"/>
        <postStartupActivity implementation="software.amazon.q.jetbrains.services.telemetry.AwsToolkitStartupMetrics"/>

        <applicationService serviceInterface="migration.software.amazon.q.jetbrains.settings.AwsSettings"
                            serviceImplementation="software.amazon.q.jetbrains.settings.DefaultAwsSettings"
                            testServiceImplementation="software.amazon.q.jetbrains.settings.MockAwsSettings"/>
        <applicationService serviceInterface="migration.software.amazon.q.jetbrains.core.credentials.ToolkitAuthManager"
                            serviceImplementation="software.amazon.q.jetbrains.core.credentials.DefaultToolkitAuthManager"/>
        <applicationService serviceInterface="migration.software.amazon.q.jetbrains.core.credentials.pinning.ConnectionPinningManager"
                            serviceImplementation="software.amazon.q.jetbrains.core.credentials.pinning.DefaultConnectionPinningManager"/>
        <applicationService serviceInterface="migration.software.amazon.q.jetbrains.core.credentials.CredentialManager"
                            serviceImplementation="software.amazon.q.jetbrains.core.credentials.DefaultCredentialManager"
                            testServiceImplementation="software.amazon.q.jetbrains.core.credentials.MockCredentialsManager"/>
        <applicationService serviceInterface="migration.software.amazon.q.jetbrains.telemetry.TelemetryService"
                            serviceImplementation="software.amazon.q.jetbrains.services.telemetry.DefaultTelemetryService"
                            testServiceImplementation="software.amazon.q.jetbrains.services.telemetry.NoOpTelemetryService"/>
        <applicationService serviceInterface="migration.software.amazon.q.jetbrains.core.AwsResourceCache"
                            serviceImplementation="software.amazon.q.jetbrains.core.DefaultAwsResourceCache"
                            testServiceImplementation="software.amazon.q.jetbrains.core.MockResourceCache"/>
        <applicationService serviceInterface="migration.software.amazon.q.core.region.ToolkitRegionProvider"
                            serviceImplementation="software.amazon.q.jetbrains.core.region.AwsRegionProvider"
                            testServiceImplementation="software.amazon.q.jetbrains.core.region.MockRegionProvider"/>
        <applicationService serviceInterface="migration.software.amazon.q.jetbrains.core.RemoteResourceResolverProvider"
                            serviceImplementation="software.amazon.q.jetbrains.core.DefaultRemoteResourceResolverProvider"/>
        <applicationService serviceInterface="migration.software.amazon.q.core.clients.SdkClientProvider"
                            serviceImplementation="software.amazon.q.jetbrains.core.AwsSdkClient"/>
        <applicationService serviceInterface="migration.software.amazon.q.core.ToolkitClientManager"
                            serviceImplementation="software.amazon.q.jetbrains.core.AwsClientManager"
                            testServiceImplementation="software.amazon.q.jetbrains.core.MockClientManager"/>
        <applicationService serviceInterface="migration.software.amazon.q.jetbrains.core.credentials.sso.SsoLoginCallbackProvider"
                            serviceImplementation="software.amazon.q.jetbrains.core.credentials.sso.DefaultSsoLoginCallbackProvider"
                            testServiceImplementation="software.amazon.q.jetbrains.core.credentials.sso.MockSsoLoginCallbackProvider"/>
        <applicationService serviceInterface="migration.software.amazon.q.jetbrains.core.credentials.profiles.ProfileWatcher"
                            serviceImplementation="software.amazon.q.jetbrains.core.credentials.profiles.DefaultProfileWatcher"/>

        <projectService serviceInterface="software.amazon.q.jetbrains.core.credentials.AwsConnectionManager"
                        serviceImplementation="software.amazon.q.jetbrains.core.credentials.DefaultAwsConnectionManager"
                        testServiceImplementation="software.amazon.q.jetbrains.core.credentials.MockAwsConnectionManager"/>
        <projectService serviceInterface="software.amazon.q.jetbrains.core.credentials.CredentialsRegionHandler"
                        serviceImplementation="software.amazon.q.jetbrains.core.credentials.DefaultCredentialsRegionHandler"
                        testServiceImplementation="software.amazon.q.jetbrains.core.credentials.MockCredentialsRegionHandler"/>
        <projectService serviceInterface="software.amazon.q.jetbrains.core.credentials.ToolkitConnectionManager"
                        serviceImplementation="software.amazon.q.jetbrains.core.credentials.DefaultToolkitConnectionManager"/>

        <!-- each plugin needs its own instance of these -->
        <applicationService serviceImplementation="migration.software.amazon.q.jetbrains.core.coroutines.PluginCoroutineScopeTracker"/>
        <projectService serviceImplementation="migration.software.amazon.q.jetbrains.core.coroutines.PluginCoroutineScopeTracker"/>
        <postStartupActivity implementation = "software.amazon.q.jetbrains.core.notifications.NotificationServiceInitializer"/>
        <postStartupActivity implementation="software.amazon.q.jetbrains.services.telemetry.AwsToolkitStartupMetrics"/>
    </extensions>
    <projectListeners>
        <listener class="software.amazon.q.jetbrains.services.telemetry.OpenedFileTypesMetricsListener" topic="com.intellij.openapi.fileEditor.FileEditorManagerListener"/>
    </projectListeners>
</idea-plugin>
